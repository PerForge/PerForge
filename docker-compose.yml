version: '3'
services:
  perforge:
    image: perforge/perforge-app:latest
    container_name: perforge
    environment:
      DATABASE_URL: postgresql+psycopg2://perforgedbuser:perforgedbpass@timescaledb:5432/perforge
    ports:
      - "7878:7878"
    volumes:
      - perforge-conf:/app/app/data/
    restart: always

  timescaledb:
    image: timescale/timescaledb:2.17.0-pg16
    container_name: timescaledb
    environment:
      POSTGRES_DB: perforge
      POSTGRES_USER: perforgedbuser
      POSTGRES_PASSWORD: perforgedbpass
    ports:
      - "5432:5432"
    volumes:
      - timescaledb-data:/var/lib/postgresql/data
    restart: always

volumes:
  perforge-conf:
  timescaledb-data:
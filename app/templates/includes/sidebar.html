<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<!-- API Client -->
<script>
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return decodeURIComponent(parts.pop().split(';').shift());
    }

    $(document).ready(function() {
        // Add project to settings dropdown
        const projectName = getCookie('project_name');

        // Remove existing project info to prevent duplicates
        $('.project-specific-item').remove();

        if (projectName) {
            const projectBlock = `
                <li class="project-specific-item"><h5 class="dropdown-header" style="text-align: center;">Current project</h5><span class="dropdown-item-text" style="text-align: center; color: grey; display: block; padding: 0.25rem 1rem;">${projectName}</span></li>
                <li class="project-specific-item"><hr class="dropdown-divider"></li>
                <li class="project-specific-item"><a class="dropdown-item" href="/choose-project"><i class="fas fa-exchange-alt me-2"></i>Change Project</a></li>
                <li class="project-specific-item"><hr class="dropdown-divider"></li>
            `;
            const settingsMenu = $('.settings-dropdown .dropdown-menu');
            settingsMenu.prepend(projectBlock);
        }

        // Highlight active nav link
        const currentPath = window.location.pathname;
        const navLinks = document.querySelectorAll('.horizontal-sidebar .nav-link');

        navLinks.forEach(link => {
            const href = link.getAttribute('href');

            if (href === '/' && (currentPath === '/' || currentPath === '/index')) {
                link.classList.add('active');
            }
            else if (href !== '/' && currentPath.startsWith(href)) {
                link.classList.add('active');
            }
        });
    });
</script>
<div class="horizontal-sidebar">
    <div class="sidebar-container">
        <div class="sidebar-header">
            <img src="/static/assets/img/logo.png" height="25" alt="PerForge">
            <a class="ms-2" type="button" href="https://perforge.app" target="_blank">PerForge</a>
        </div>
        <div class="nav-links-container">
            <a class="nav-link" type="button" href="/">
                <span class="nav-link-icon"><i class="fas fa-home"></i></span>
                <span class="nav-link-text">Home</span>
            </a>
            <a class="nav-link" type="button" href="/tests">
                <span class="nav-link-icon"><i class="fas fa-tachometer-alt"></i></span>
                <span class="nav-link-text">Tests</span>
            </a>
            <a class="nav-link" type="button" href="/templates">
                <span class="nav-link-icon"><i class="fa-solid fa-diagram-project"></i></span>
                <span class="nav-link-text">Templates</span>
            </a>
            <a class="nav-link" type="button" href="/graphs">
                <span class="nav-link-icon"><i class="fas fa-chart-area"></i></span>
                <span class="nav-link-text">Graphs</span>
            </a>
            <a class="nav-link" type="button" href="/nfrs">
                <span class="nav-link-icon"><i class="far fa-check-circle"></i></span>
                <span class="nav-link-text">NFRs</span>
            </a>
            <a class="nav-link" type="button" href="/prompts">
                <span class="nav-link-icon"><i class="fa-solid fa-list"></i></span>
                <span class="nav-link-text">Prompts</span>
            </a>
            <a class="nav-link" type="button" href="/integrations">
                <span class="nav-link-icon"><i class="fas fa-link"></i></span>
                <span class="nav-link-text">Integrations</span>
            </a>
            <a class="nav-link" type="button" href="/secrets">
                <span class="nav-link-icon"><i class="fa-solid fa-key"></i></span>
                <span class="nav-link-text">Secrets</span>
            </a>
        </div>
        <div class="settings-dropdown dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" id="settingsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                <span class="nav-link-icon"><i class="fas fa-cog"></i></span>
                <span class="nav-link-text">Settings</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="settingsDropdown" data-bs-auto-close="outside">
                <li>
                    <button class="dropdown-item" id="themeSwitcher" type="button">
                        <i id="themeIcon" class="fas fa-sun me-2"></i>Theme
                    </button>
                </li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="/register">
                    <i class="fas fa-user-plus me-2"></i>Add user
                </a></li>
                <li><a class="dropdown-item" href="/view-logs">
                    <i class="fas fa-clipboard-list me-2"></i>View logs
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="/logout">
                    <i class="fas fa-sign-out-alt me-2"></i>Sign out
                </a></li>
            </ul>
        </div>
    </div>
</div>
